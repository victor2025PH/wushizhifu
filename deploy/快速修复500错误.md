# ğŸš€ å¿«é€Ÿä¿®å¤ 500 Internal Server Error

æ ¹æ®é”™è¯¯æ—¥å¿—åˆ†æï¼Œä¸»è¦é—®é¢˜æ˜¯ï¼š
1. âŒ å‰ç«¯æ–‡ä»¶ä¸å­˜åœ¨ (`/opt/wushizhifu/frontend/dist` ä¸å­˜åœ¨)
2. âŒ Nginx é…ç½®è·¯å¾„ä¸å®é™…é¡¹ç›®è·¯å¾„ä¸ä¸€è‡´
3. âŒ API æœåŠ¡æœªè¿è¡Œï¼ˆä¸å½±å“å‰ç«¯ï¼Œä½†å½±å“ API è°ƒç”¨ï¼‰

## âš¡ å¿«é€Ÿä¿®å¤ï¼ˆæ¨èï¼‰

åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# 1. ä¸‹è½½å¹¶æ‰§è¡Œä¿®å¤è„šæœ¬
cd ~
wget https://raw.githubusercontent.com/victor2025PH/wushizhifu/main/deploy/ä¿®å¤500é”™è¯¯.sh
chmod +x ä¿®å¤500é”™è¯¯.sh
sudo ./ä¿®å¤500é”™è¯¯.sh
```

æˆ–è€…ç›´æ¥æ‰‹åŠ¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤ï¼š

## ğŸ“‹ æ‰‹åŠ¨ä¿®å¤æ­¥éª¤

### æ­¥éª¤ 1: ç¡®è®¤é¡¹ç›®ä½ç½®

```bash
# æ£€æŸ¥é¡¹ç›®åœ¨å“ªé‡Œ
ls -la ~/wushizhifu/frontend/package.json
# æˆ–
ls -la /opt/wushizhifu/frontend/package.json
```

### æ­¥éª¤ 2: æ„å»ºå‰ç«¯

```bash
# å¦‚æœé¡¹ç›®åœ¨ ~/wushizhifu
cd ~/wushizhifu/frontend

# å¦‚æœé¡¹ç›®åœ¨ /opt/wushizhifu
cd /opt/wushizhifu/frontend

# è®¾ç½®æƒé™å¹¶æ„å»º
sudo chown -R ubuntu:ubuntu dist 2>/dev/null || true
npm install
npm run build

# æ£€æŸ¥æ„å»ºç»“æœ
ls -la dist/index.html
```

### æ­¥éª¤ 3: è®¾ç½®æƒé™

```bash
# å‡è®¾é¡¹ç›®åœ¨ ~/wushizhifu
FRONTEND_DIR="$HOME/wushizhifu/frontend"

# æˆ–å¦‚æœåœ¨ /opt/wushizhifu
# FRONTEND_DIR="/opt/wushizhifu/frontend"

sudo chown -R www-data:www-data $FRONTEND_DIR/dist
sudo chmod -R 755 $FRONTEND_DIR/dist
```

### æ­¥éª¤ 4: ä¿®å¤ Nginx é…ç½®

```bash
# ç¼–è¾‘ Nginx é…ç½®
sudo nano /etc/nginx/sites-available/wushizhifu

# æ‰¾åˆ°è¿™ä¸€è¡Œï¼š
# root /opt/wushizhifu/frontend/dist;
# æˆ–
# root /home/ubuntu/wushizhifu/frontend/dist;

# ä¿®æ”¹ä¸ºå®é™…çš„é¡¹ç›®è·¯å¾„ï¼Œä¾‹å¦‚ï¼š
root /home/ubuntu/wushizhifu/frontend/dist;

# ä¿å­˜å¹¶é€€å‡ºï¼ˆCtrl+O, Enter, Ctrl+Xï¼‰
```

### æ­¥éª¤ 5: æµ‹è¯•å¹¶é‡è½½ Nginx

```bash
sudo nginx -t
sudo systemctl reload nginx
```

### æ­¥éª¤ 6: éªŒè¯ä¿®å¤

```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
ls -la ~/wushizhifu/frontend/dist/index.html

# æ£€æŸ¥ Nginx é”™è¯¯æ—¥å¿—
sudo tail -20 /var/log/nginx/error.log

# æµ‹è¯•ç½‘ç«™
curl -I https://50zf.usdt2026.cc
```

## ğŸ”§ ä¿®å¤ API æœåŠ¡ï¼ˆå¯é€‰ï¼‰

å¦‚æœ API æœåŠ¡ä¹Ÿéœ€è¦è¿è¡Œï¼š

```bash
# æ£€æŸ¥ API æœåŠ¡æ˜¯å¦åœ¨è¿è¡Œ
curl http://127.0.0.1:8000/

# å¦‚æœæ²¡æœ‰è¿è¡Œï¼Œå¯åŠ¨å®ƒ
cd ~/wushizhifu  # æˆ– /opt/wushizhifu
source venv/bin/activate  # å¦‚æœæœ‰è™šæ‹Ÿç¯å¢ƒ
python3 -m uvicorn api_server:app --host 127.0.0.1 --port 8000

# æˆ–ä½¿ç”¨ systemd æœåŠ¡ï¼ˆå¦‚æœå·²é…ç½®ï¼‰
sudo systemctl start wushipay-api.service
sudo systemctl status wushipay-api.service
```

## ğŸ› å¦‚æœä»æœ‰é—®é¢˜

### æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—

```bash
sudo tail -50 /var/log/nginx/error.log
```

### æ£€æŸ¥ Nginx å®é™…é…ç½®

```bash
sudo nginx -T | grep -A 5 "server_name 50zf.usdt2026.cc" | grep "root"
```

### æ£€æŸ¥æ–‡ä»¶æƒé™

```bash
ls -ld ~/wushizhifu/frontend/dist
ls -la ~/wushizhifu/frontend/dist/ | head -5
```

### æ£€æŸ¥ SELinuxï¼ˆå¦‚æœå¯ç”¨ï¼‰

```bash
getenforce
# å¦‚æœæ˜¯ Enforcingï¼Œéœ€è¦è®¾ç½®ä¸Šä¸‹æ–‡
sudo chcon -R -t httpd_sys_content_t ~/wushizhifu/frontend/dist
```

## âœ… é¢„æœŸç»“æœ

ä¿®å¤æˆåŠŸåï¼š
- âœ… `ls -la ~/wushizhifu/frontend/dist/index.html` åº”è¯¥æ˜¾ç¤ºæ–‡ä»¶å­˜åœ¨
- âœ… `sudo nginx -t` åº”è¯¥æ˜¾ç¤º "syntax is ok"
- âœ… è®¿é—® `https://50zf.usdt2026.cc` åº”è¯¥æ­£å¸¸æ˜¾ç¤ºé¡µé¢
- âœ… `sudo tail /var/log/nginx/error.log` åº”è¯¥æ²¡æœ‰æ–°çš„é”™è¯¯

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœæŒ‰ç…§ä»¥ä¸Šæ­¥éª¤ä»æ— æ³•è§£å†³ï¼Œè¯·æä¾›ï¼š
1. `sudo tail -50 /var/log/nginx/error.log` çš„è¾“å‡º
2. `ls -la ~/wushizhifu/frontend/dist/` çš„è¾“å‡º
3. `sudo nginx -T | grep -A 10 "server_name 50zf.usdt2026.cc"` çš„è¾“å‡º

