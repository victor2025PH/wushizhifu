# æœåŠ¡å™¨è¯Šæ–­å’Œé‡å¯æŒ‡å—

## ğŸ” å½“å‰æœåŠ¡å™¨çŠ¶æ€

ä»æˆªå›¾çœ‹ï¼ŒæœåŠ¡å™¨èµ„æº**æ­£å¸¸**ï¼š
- âœ… CPU è´Ÿè½½ï¼š0.0ï¼ˆéå¸¸ä½ï¼‰
- âœ… å†…å­˜ä½¿ç”¨ï¼š18%ï¼ˆå……è¶³ï¼‰
- âœ… ç£ç›˜ä½¿ç”¨ï¼š22.3%ï¼ˆå……è¶³ï¼‰
- âœ… è¿›ç¨‹æ•°ï¼š116ï¼ˆæ­£å¸¸ï¼‰

**ç»“è®ºï¼šæœåŠ¡å™¨æœ¬èº«æ²¡æœ‰é—®é¢˜ï¼Œä¸éœ€è¦é‡å¯ã€‚**

## ğŸ“‹ é—®é¢˜è¯Šæ–­

### æƒ…å†µ 1ï¼šå‘½ä»¤æ‰§è¡Œäº†ä½†æ²¡æœ‰è¾“å‡º

å¦‚æœå‘½ä»¤æ‰§è¡Œååªè¿”å›æç¤ºç¬¦ï¼Œæ²¡æœ‰è¾“å‡ºï¼Œå¯èƒ½æ˜¯ï¼š

1. **æœåŠ¡ä¸å­˜åœ¨**
2. **æœåŠ¡æ²¡æœ‰è¿è¡Œ**
3. **æœåŠ¡æ²¡æœ‰æ—¥å¿—**

### æƒ…å†µ 2ï¼šæ£€æŸ¥æœåŠ¡æ˜¯å¦å­˜åœ¨

```bash
# æ–¹æ³•1ï¼šæ£€æŸ¥æœåŠ¡æ–‡ä»¶
ls -la /etc/systemd/system/otc-bot.service

# æ–¹æ³•2ï¼šæ£€æŸ¥æœåŠ¡æ˜¯å¦æ³¨å†Œ
sudo systemctl list-unit-files | grep otc-bot

# æ–¹æ³•3ï¼šæ£€æŸ¥æ‰€æœ‰ bot ç›¸å…³æœåŠ¡
sudo systemctl list-units --all | grep -i bot
```

### æƒ…å†µ 3ï¼šæ£€æŸ¥æœåŠ¡æ˜¯å¦è¿è¡Œ

```bash
# æ£€æŸ¥è¿›ç¨‹
ps aux | grep python | grep bot

# æˆ–è€…æ›´è¯¦ç»†
ps aux | grep -E "bot.py|python.*bot" | grep -v grep
```

## ğŸš€ å®Œæ•´è¯Šæ–­æ­¥éª¤

### æ­¥éª¤ 1ï¼šç¡®è®¤æœåŠ¡æ–‡ä»¶å­˜åœ¨

```bash
echo "=== æ­¥éª¤1ï¼šæ£€æŸ¥æœåŠ¡æ–‡ä»¶ ==="
ls -la /etc/systemd/system/otc-bot.service
```

**å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼š**
```bash
# æ£€æŸ¥æ¨¡æ¿æ–‡ä»¶
ls -la /home/ubuntu/wushizhifu/botB/otc-bot.service

# å¦‚æœæ¨¡æ¿å­˜åœ¨ï¼Œåˆ›å»ºæœåŠ¡
sudo cp /home/ubuntu/wushizhifu/botB/otc-bot.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable otc-bot
sudo systemctl start otc-bot
```

### æ­¥éª¤ 2ï¼šæ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
echo "=== æ­¥éª¤2ï¼šæ£€æŸ¥æœåŠ¡çŠ¶æ€ ==="
sudo systemctl status otc-bot -l --no-pager
```

**å¦‚æœæ˜¾ç¤º "Unit otc-bot.service could not be found"ï¼š**
- æœåŠ¡æ–‡ä»¶ä¸å­˜åœ¨ï¼Œéœ€è¦åˆ›å»ºï¼ˆè§æ­¥éª¤1ï¼‰

**å¦‚æœæ˜¾ç¤º "Active: inactive (dead)"ï¼š**
- æœåŠ¡å­˜åœ¨ä½†æ²¡æœ‰è¿è¡Œï¼Œéœ€è¦å¯åŠ¨ï¼š
```bash
sudo systemctl start otc-bot
sudo systemctl status otc-bot
```

### æ­¥éª¤ 3ï¼šæ£€æŸ¥è¿›ç¨‹

```bash
echo "=== æ­¥éª¤3ï¼šæ£€æŸ¥è¿›ç¨‹ ==="
ps aux | grep -E "bot.py|python.*bot" | grep -v grep
```

**å¦‚æœæ²¡æœ‰è¿›ç¨‹ï¼š**
- Bot æ²¡æœ‰è¿è¡Œï¼Œéœ€è¦å¯åŠ¨æœåŠ¡

### æ­¥éª¤ 4ï¼šæ£€æŸ¥æ—¥å¿—

```bash
echo "=== æ­¥éª¤4ï¼šæ£€æŸ¥æ—¥å¿— ==="
sudo journalctl -u otc-bot -n 20 --no-pager
```

**å¦‚æœæ²¡æœ‰æ—¥å¿—ï¼š**
- å¯èƒ½æ˜¯æœåŠ¡åˆšå¯åŠ¨ï¼Œè¿˜æ²¡æœ‰äº§ç”Ÿæ—¥å¿—
- æˆ–è€…æœåŠ¡é…ç½®æœ‰é—®é¢˜

## ğŸ”§ ä¸€é”®è¯Šæ–­å‘½ä»¤

**å¤åˆ¶å¹¶æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ï¼š**

```bash
echo "==========================================" && \
echo "Bot æœåŠ¡å®Œæ•´è¯Šæ–­" && \
echo "==========================================" && \
echo "" && \
echo "1. æœåŠ¡æ–‡ä»¶ï¼š" && \
ls -la /etc/systemd/system/otc-bot.service 2>&1 && \
echo "" && \
echo "2. æœåŠ¡çŠ¶æ€ï¼š" && \
sudo systemctl status otc-bot --no-pager -l 2>&1 | head -20 && \
echo "" && \
echo "3. è¿›ç¨‹æ£€æŸ¥ï¼š" && \
ps aux | grep -E "bot.py|python.*bot" | grep -v grep && \
echo "" && \
echo "4. æ—¥å¿—æ£€æŸ¥ï¼ˆæœ€è¿‘10è¡Œï¼‰ï¼š" && \
sudo journalctl -u otc-bot -n 10 --no-pager 2>&1 && \
echo "" && \
echo "5. å·¥ä½œç›®å½•ï¼š" && \
ls -la /home/ubuntu/wushizhifu/botB/bot.py 2>&1 && \
echo "" && \
echo "=========================================="
```

## âš ï¸ æ˜¯å¦éœ€è¦é‡å¯ï¼Ÿ

### ä¸éœ€è¦é‡å¯çš„æƒ…å†µï¼š

1. âœ… **æœåŠ¡å™¨èµ„æºæ­£å¸¸**ï¼ˆå½“å‰æƒ…å†µï¼‰
2. âœ… **å‘½ä»¤å¯ä»¥æ‰§è¡Œ**ï¼ˆåªæ˜¯æ²¡æœ‰è¾“å‡ºï¼‰
3. âœ… **SSH è¿æ¥æ­£å¸¸**
4. âœ… **å…¶ä»–æœåŠ¡æ­£å¸¸**

### éœ€è¦é‡å¯çš„æƒ…å†µï¼š

1. âŒ **æœåŠ¡å™¨å®Œå…¨æ— å“åº”**
2. âŒ **SSH è¿æ¥æ–­å¼€**
3. âŒ **ç³»ç»Ÿè´Ÿè½½è¿‡é«˜**
4. âŒ **å†…å­˜/ç£ç›˜è€—å°½**

**å½“å‰æƒ…å†µï¼šä¸éœ€è¦é‡å¯**

## ğŸ› ï¸ è§£å†³æ–¹æ¡ˆ

### æ–¹æ¡ˆ 1ï¼šå¦‚æœæœåŠ¡ä¸å­˜åœ¨

```bash
# åˆ›å»ºæœåŠ¡æ–‡ä»¶
sudo cp /home/ubuntu/wushizhifu/botB/otc-bot.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable otc-bot
sudo systemctl start otc-bot

# æ£€æŸ¥çŠ¶æ€
sudo systemctl status otc-bot
```

### æ–¹æ¡ˆ 2ï¼šå¦‚æœæœåŠ¡å­˜åœ¨ä½†æ²¡æœ‰è¿è¡Œ

```bash
# å¯åŠ¨æœåŠ¡
sudo systemctl start otc-bot

# æ£€æŸ¥å¯åŠ¨æ—¥å¿—
sudo journalctl -u otc-bot -n 50 --no-pager

# å¦‚æœå¯åŠ¨å¤±è´¥ï¼ŒæŸ¥çœ‹é”™è¯¯
sudo systemctl status otc-bot -l --no-pager
```

### æ–¹æ¡ˆ 3ï¼šå¦‚æœæœåŠ¡è¿è¡Œä½†æ²¡æœ‰æ—¥å¿—

```bash
# æ£€æŸ¥æœåŠ¡é…ç½®
sudo systemctl show otc-bot | grep -E "StandardOutput|StandardError"

# åº”è¯¥æ˜¾ç¤º "journal" æˆ– "syslog"
# å¦‚æœä¸æ˜¯ï¼Œéœ€è¦ä¿®æ”¹æœåŠ¡æ–‡ä»¶
```

### æ–¹æ¡ˆ 4ï¼šç›´æ¥è¿è¡ŒæŸ¥çœ‹è¾“å‡º

å¦‚æœ systemd æœåŠ¡æœ‰é—®é¢˜ï¼Œå¯ä»¥ä¸´æ—¶ç›´æ¥è¿è¡Œï¼š

```bash
cd /home/ubuntu/wushizhifu/botB
source venv/bin/activate
python bot.py
```

è¿™æ ·å¯ä»¥ï¼š
- çœ‹åˆ°æ‰€æœ‰è¾“å‡º
- çœ‹åˆ°é”™è¯¯ä¿¡æ¯
- ç¡®è®¤ bot æ˜¯å¦èƒ½æ­£å¸¸å¯åŠ¨

## ğŸ“ å»ºè®®çš„æ‰§è¡Œé¡ºåº

1. **å…ˆè¿è¡Œä¸€é”®è¯Šæ–­å‘½ä»¤**ï¼ˆä¸Šé¢çš„å®Œæ•´è¯Šæ–­ï¼‰
2. **æ ¹æ®è¾“å‡ºç»“æœåˆ¤æ–­ï¼š**
   - å¦‚æœæœåŠ¡æ–‡ä»¶ä¸å­˜åœ¨ â†’ åˆ›å»ºæœåŠ¡æ–‡ä»¶
   - å¦‚æœæœåŠ¡æœªè¿è¡Œ â†’ å¯åŠ¨æœåŠ¡
   - å¦‚æœæœåŠ¡è¿è¡Œä½†æ²¡æœ‰æ—¥å¿— â†’ æ£€æŸ¥æœåŠ¡é…ç½®
3. **å¦‚æœè¿˜æ˜¯ä¸è¡Œ** â†’ ç›´æ¥è¿è¡Œ `python bot.py` æŸ¥çœ‹è¾“å‡º
4. **åªæœ‰åœ¨æœåŠ¡å™¨å®Œå…¨æ— å“åº”æ—¶æ‰è€ƒè™‘é‡å¯**

## ğŸ’¡ é‡è¦æç¤º

1. **ä¸è¦ç«‹å³é‡å¯** - å…ˆè¯Šæ–­é—®é¢˜
2. **æœåŠ¡å™¨èµ„æºæ­£å¸¸** - ä¸æ˜¯èµ„æºé—®é¢˜
3. **å‘½ä»¤å¯ä»¥æ‰§è¡Œ** - ä¸æ˜¯ç³»ç»Ÿé—®é¢˜
4. **å¯èƒ½æ˜¯æœåŠ¡é…ç½®é—®é¢˜** - éœ€è¦æ£€æŸ¥æœåŠ¡æ–‡ä»¶

## ğŸ”„ å¦‚æœçœŸçš„éœ€è¦é‡å¯

å¦‚æœè¯Šæ–­åç¡®è®¤éœ€è¦é‡å¯ï¼š

```bash
# 1. å…ˆä¿å­˜å½“å‰çŠ¶æ€
sudo systemctl status otc-bot > /tmp/bot_status_before_restart.txt

# 2. é‡å¯æœåŠ¡å™¨
sudo reboot

# 3. é‡å¯åæ£€æŸ¥æœåŠ¡
sudo systemctl status otc-bot
```

**ä½†æ ¹æ®å½“å‰æƒ…å†µï¼Œä¸å»ºè®®é‡å¯ã€‚**
