# ç›®å½•ç»“æ„è¿ç§»è¯´æ˜

## ğŸ“‹ è¿ç§»æ­¥éª¤

### 1. é‡å‘½åç›®å½•

#### åœ¨æœ¬åœ°æ‰§è¡Œï¼š

**Windows (PowerShell):**
```powershell
cd D:\wushizhifu
Rename-Item -Path "wushizhifu-bot" -NewName "botA"
Rename-Item -Path "wushizhifu-otc-bot" -NewName "botB"
```

**æˆ–è€…æ‰‹åŠ¨é‡å‘½åæ–‡ä»¶å¤¹**

### 2. æ›´æ–° .env æ–‡ä»¶ä½ç½®

å°† `.env` æ–‡ä»¶ç§»åˆ°é¡¹ç›®æ ¹ç›®å½• `D:\wushizhifu\.env`ï¼Œç¡®ä¿åŒ…å«ï¼š

```env
BOT_TOKEN=your_bot_a_token_here
BOT_TOKEN_B=your_bot_b_token_here
```

### 3. æäº¤åˆ° GitHub

```bash
cd D:\wushizhifu
git add .
git commit -m "é‡æ„ç›®å½•ç»“æ„ï¼šbotA å’Œ botB åˆ†ç¦»"
git push origin main
```

### 4. åœ¨æœåŠ¡å™¨ä¸Šæ›´æ–°

```bash
cd /home/ubuntu/wushizhifu

# å¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œåˆ›å»º
mkdir -p botA botB

# å¦‚æœæ˜¯æ–°éƒ¨ç½²ï¼Œå…‹éš†ä»“åº“
# git clone https://github.com/victor2025PH/wushizhifu.git .

# å¦‚æœæ˜¯ç°æœ‰éƒ¨ç½²ï¼Œæ‹‰å–æ›´æ–°
git pull origin main

# ç§»åŠ¨ .env åˆ°æ ¹ç›®å½•ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
# cp bot/.env .env  # å¦‚æœåŸæ¥åœ¨ bot ç›®å½•
```

### 5. åˆ›å»º systemd æœåŠ¡

#### Bot A æœåŠ¡ (`/etc/systemd/system/botA.service`):

```ini
[Unit]
Description=WuShiPay Telegram Bot (Bot A)
After=network.target

[Service]
Type=simple
User=ubuntu
WorkingDirectory=/home/ubuntu/wushizhifu/botA
Environment="PATH=/home/ubuntu/wushizhifu/botA/venv/bin"
ExecStart=/home/ubuntu/wushizhifu/botA/venv/bin/python /home/ubuntu/wushizhifu/botA/bot.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

#### Bot B æœåŠ¡ (`/etc/systemd/system/botB.service`):

```ini
[Unit]
Description=OTC Group Management Bot (Bot B)
After=network.target

[Service]
Type=simple
User=ubuntu
WorkingDirectory=/home/ubuntu/wushizhifu/botB
Environment="PATH=/home/ubuntu/wushizhifu/botB/venv/bin"
ExecStart=/home/ubuntu/wushizhifu/botB/venv/bin/python /home/ubuntu/wushizhifu/botB/bot.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

#### å¯ç”¨æœåŠ¡ï¼š

```bash
sudo systemctl daemon-reload
sudo systemctl enable botA.service
sudo systemctl enable botB.service
sudo systemctl start botA.service
sudo systemctl start botB.service
```

### 6. é…ç½® GitHub Actions Secrets

åœ¨ GitHub ä»“åº“è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ Secretsï¼š

1. è¿›å…¥ `Settings` -> `Secrets and variables` -> `Actions`
2. æ·»åŠ ä»¥ä¸‹ secretsï¼š
   - `SERVER_HOST`: æœåŠ¡å™¨ IP (ä¾‹å¦‚: 165.154.203.182)
   - `SERVER_USER`: SSH ç”¨æˆ·å (ä¾‹å¦‚: ubuntu)
   - `SSH_PRIVATE_KEY`: SSH ç§é’¥å†…å®¹
   - `SSH_PORT`: SSH ç«¯å£ (å¯é€‰ï¼Œé»˜è®¤ 22)

## âœ… éªŒè¯

1. **éªŒè¯ç›®å½•ç»“æ„ï¼š**
```bash
cd /home/ubuntu/wushizhifu
ls -la
# åº”è¯¥çœ‹åˆ°: botA/, botB/, .env
```

2. **éªŒè¯æœåŠ¡çŠ¶æ€ï¼š**
```bash
sudo systemctl status botA.service
sudo systemctl status botB.service
```

3. **æµ‹è¯• GitHub Actionsï¼š**
   - ä¿®æ”¹ `botA/` æˆ– `botB/` ä¸‹çš„ä»»æ„æ–‡ä»¶
   - æ¨é€åˆ° GitHub
   - æŸ¥çœ‹ Actions æ ‡ç­¾é¡µï¼Œåº”è¯¥è‡ªåŠ¨è§¦å‘éƒ¨ç½²

## ğŸ”„ å›æ»šæ–¹æ¡ˆ

å¦‚æœå‡ºç°é—®é¢˜ï¼Œå¯ä»¥æ‰‹åŠ¨å›æ»šï¼š

```bash
cd /home/ubuntu/wushizhifu
git reset --hard HEAD~1
sudo systemctl restart botA.service
sudo systemctl restart botB.service
```

